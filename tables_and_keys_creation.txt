USE MechanicShop;

CREATE TABLE customers (
    customer_id INT NOT NULL,
    customer_Lname NVARCHAR(50) NOT NULL,
    customer_phone INT NOT NULL,
    customer_city NVARCHAR(50) NOT NULL,
    customer_street NVARCHAR(50) NOT NULL,
    customer_apartment_number INT NOT NULL,
    customer_state NVARCHAR(2) NOT NULL,
    customer_zip INT NOT NULL,
    customer_email NVARCHAR(50) NOT NULL, 
    CONSTRAINT pk_customers PRIMARY KEY (customer_id)
);

CREATE TABLE vehicles (
    vehicle_id INT NOT NULL,
    customer_id INT NOT NULL,
    vehicle_model NVARCHAR(50) NOT NULL,
    vehicle_trim NVARCHAR(50) NOT NULL,
    vehicle_year INT NOT NULL,
    vehicle_license_plate NVARCHAR(7) NOT NULL,
    vehicle_color NVARCHAR(50) NOT NULL,
    vehicle_vin NVARCHAR(50) NOT NULL,
    vehicle_make NVARCHAR(50) NOT NULL,
    CONSTRAINT pk_vehicles PRIMARY KEY (vehicle_id),
    CONSTRAINT fk_vehicles_customers FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);

CREATE TABLE services (
    service_id INT NOT NULL,
    service_name NVARCHAR(50) NOT NULL,
    service_description NVARCHAR(100) NOT NULL,
    service_cost FLOAT NOT NULL,
    service_rank_requirement NVARCHAR(50) NOT NULL,
    CONSTRAINT pk_services PRIMARY KEY (service_id)
);

CREATE TABLE technician_rank (
    technician_rank_id INT NOT NULL,
    technician_rank NVARCHAR(10) NOT NULL,
    rank_value FLOAT NOT NULL,
    CONSTRAINT pk_technician_rank PRIMARY KEY (technician_rank_id)
);

CREATE TABLE technicians (
    technician_id INT NOT NULL,
    technician_Fname NVARCHAR(50) NOT NULL,
    technician_Lname NVARCHAR(50) NOT NULL,
    technician_rank_id INT NOT NULL,
    CONSTRAINT pk_technicians PRIMARY KEY (technician_id),
    CONSTRAINT fk_technicians_technician_rank FOREIGN KEY (technician_rank_id) REFERENCES technician_rank(technician_rank_id)
);

CREATE TABLE service_history (
    service_record_id INT NOT NULL,
    customer_id INT NOT NULL,
    vehicle_id INT NOT NULL,
    service_id INT NOT NULL,
    technician_id INT NOT NULL,
    service_record_date NVARCHAR(10) NOT NULL,
    service_record_time INT NOT NULL,
    service_record_status BIT NOT NULL,
    CONSTRAINT pk_service_history PRIMARY KEY (service_record_id),
    CONSTRAINT fk_service_history_customers FOREIGN KEY (customer_id) REFERENCES customers(customer_id),
    CONSTRAINT fk_service_history_vehicles FOREIGN KEY (vehicle_id) REFERENCES vehicles(vehicle_id),
    CONSTRAINT fk_service_history_services FOREIGN KEY (service_id) REFERENCES services(service_id),
    CONSTRAINT fk_service_history_technicians FOREIGN KEY (technician_id) REFERENCES technicians(technician_id)
);
